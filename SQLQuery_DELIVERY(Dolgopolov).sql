Create Database Delivery go
 USE Delivery
 Go
CREATE TABLE [Тип клієнта](
[Id] varchar(10) NOT NULL,
[Назва типу ] nvarchar(50) NOT NULL,
[Знижка] int NOT NULL,
[Опис] [nvarchar](150)  null,
constraint [Тип клієнти первинний ключ] Primary Key  (Id)
) 
GO
CREATE TABLE Клієнти  (
 Id varchar(10) not null,
 Прізвище nvarchar(50) not null,
 Імя nvarchar(50) not null,
 [По-батькові] nvarchar(50) not null,
 [Номер тел] char(13) not null,
 [Код типу] varchar(10) not null,
 [Email] varchar(50) not null,
 Constraint [унікальний емейл] Unique (Email),
 Constraint [унікальний тел.] Unique ([Номер тел]),
 constraint [клієнти первинний ключ] Primary Key  (Id),
 constraint [клієнт- тип клієнта] Foreign key([Код типу])
 References [Тип клієнта] (Id)
 On update cascade 
 On Delete cascade) 
 Go
CREATE TABLE [Тип відділення](
Id varchar(10) not null,
[Назва] nvarchar(50) NOT NULL,
[Опис] nvarchar(150) null,
constraint [Тип відділення первинний ключ] Primary Key  (Id),
constraint [перевірка типів] check  ([Назва] in ('Мале', 'Середнє', 'Велике'))
)
GO
CREATE TABLE Відділення (
[Id] varchar(10) NOT NULL,
[Id типу] varchar(10) NOT NULL,
[Область] nvarchar(50) NOT NULL,
[Місто] nvarchar(50) NOT NULL,
[Адреса] nvarchar(50) NOT NULL,
[Номер тел] char(13) not null,
constraint[відділення первинний ключ] Primary Key (Id),
constraint "відділення - тип" Foreign key([Id типу])
References [Тип відділення] (Id)
On update cascade 
On Delete cascade) 
Go 
CREATE TABLE [Працівники](
[Id]  varchar(10) NOT NULL,
[Прізвище] nvarchar(50) NOT NULL,
[Імя] nvarchar(50) NOT NULL,
[По-батькові] nvarchar(50) NOT NULL,
[Номер тел] char(13) not null,
Constraint [унікальний тел] Unique ([Номер тел]),
Constraint[працівники первинний ключ] Primary Key (Id))
GO
CREATE TABLE [Упаковка](
[Id]  varchar(10) NOT NULL,
[Назва] nvarchar(50) NOT NULL,
[Опис] nvarchar(150) null,
constraint [упаковка первинний ключ] Primary Key  (Id))
GO
CREATE TABLE Постачальники (
Id varchar(10) NOT NULL ,
Назва nvarchar(50) NOT NULL,
Адреса nvarchar(50) NOT NULL,
Email varchar(50) NOT NULL,
[Номер тел] char(13) not null,
CONSTRAINT [Постачальники первинний ключ] PRIMARY KEY (Id),
CONSTRAINT [унікальний емейл пост] UNIQUE (Email),
CONSTRAINT [унікальний тел пост] Unique ([Номер тел]))
go	 
CREATE TABLE [Замовлення упаковки](
Id  int identity (1,1),
[Id постачальника] varchar(10) NOT NULL,
[Id упаковки]  varchar(10) NOT NULL,
Дата  datetime NOT NULL,
Ціна float not null,
Кількість int not null, 
CONSTRAINT [Замовлення упаковки первинний ключ] PRIMARY KEY (Id),
CONSTRAINT "Замовлення упаковки - постачальники" Foreign key([Id постачальника])
references Постачальники (Id)
On update cascade 
On Delete cascade,
CONSTRAINT "Замовлення упаковки - упаковка" Foreign key([Id упаковки])
references [Упаковка] (Id)
On update cascade 
On Delete cascade)
go 
CREATE TABLE Замовлення  (
Id int identity (1,1),
[Id відпрівника] varchar(10) not null,
[Id отримувача] varchar(10) not null,
[Id відділення відправника] varchar(10) not null,
[Id відділення отримуача] varchar(10) not null,
[Id упаковки] varchar(10) not null,
[Id оп. відправника] varchar(10) not null,
[Id оп. отримувача] varchar(10) not null,
[Дата відправлення] datetime not null,
[Дата отримання] datetime not null,
[Вартість доставки]  FLOAT not  NULL,
constraint [перевірка вибору відділень] check ([Id відділення відправника] <> [Id відділення отримуача]),
constraint [перевірка вибору операторів] check ([Id оп. відправника] != [Id оп. отримувача]),
constraint [перевірка вибору дати] check ([Дата відправлення]< [Дата отримання]),
constraint [Замовлення первинний ключ] Primary Key  (id),
constraint "Замовлення - відпраник " Foreign key([Id відпрівника])
References Клієнти (Id)
On update cascade 
On Delete cascade ,
constraint "Замовлення - отримуач" Foreign key([Id отримувача])
References Клієнти (Id)
On update no action  
On Delete no action,
constraint "замовлення - оператор_відправник" Foreign key([Id оп. відправника])
References Працівники (Id)
On update cascade 
On Delete cascade,
constraint "замовлення - оператор_одержувач" Foreign key([Id оп. отримувача])
References Працівники (Id)
On update no action 
On Delete no action, 
constraint "замовлення - відділення отримувач" Foreign key([Id відділення отримуача])
References Відділення (Id)
On update no action 
On Delete no action, 
constraint "замовлення - відділення відпраник" Foreign key([Id відділення відправника])
References Відділення (Id)
On update no action 
On Delete no action, 
constraint "замовлення - упаковка" Foreign key([Id упаковки])
References Упаковка (Id)
On update no action 
On Delete no action)
Go
Use Delivery
go 

select * from Клієнти


INSERT INTO [Тип клієнта]([Id],[Назва типу ],[Знижка],[Опис])VALUES
('0','Стандарт','0','<10 замовлень'),
('1','Бронза','5','>10 замовлень'),
('2','Срібло','7','>25 замовлень'),
('3','Золото','10','>50 замовлень')
go
INSERT INTO Клієнти([Id],[Прізвище],[Імя],[По-батькові],[Номер тел],[Email],[Код типу]) VALUES
('1','Сергієнко','Любов','Сергійовна','+380269241494','zivancenko@gmail.com','0'),
('2','Сергієнко','Василь','Петрович','+380935060396','lubov.mirosnice@ukr.net','2'),
('3','Крамаренко','Дмитро','Федорович','+380969514350','vvasilcuk@mail.ru','3'),
('4','Дмитренко','Галина','Васильовна','+380638809392','valentina61@mail.ru','1'),
('5','Кравчук','Василь','Володимирович','+380996246724','fzaharcuk@gmail.com','2'),
('6','Боднаренко','Геннадій','Євгенійович','+380960394904','svitlana.bodnar@gmail.com','3'),
('7','Пономарчук','Алла','Романівна','+380962429187','stanislav79@mail.ru','1'),
('8','Кравчук','Руслан','Тарасович','+380504102316','amelnicenko@ukr.net','2'),
('9','Павлюк','Георгій','Євгенійович','+380634041663','katerina.panasu@ukr.net','3'),
('10','Романченко','Болеслав','Романович','+380635973786','olena26@ukr.net','1'),
('11','Боднаренко','Людмила','Борисовна','+380638792885','boris.kramarenk@ukr.net','2'),
('12','Шинкаренко','Катерина','Іванівна','+380638992885','kativ@gmail.com','3'),
('13','Пономарчук','Болеслав','Іванович','+380938992885','ponamarak@ukr.net','1'),
('14','Таращук','Ольга','Петрівна','+380738992885','olgapetro@gmail.com','2'),
('15','Шевчук','Юля','Ігорівна','+380638992887','shev@gmail.com','2'),
('16','Івашків','Максим','Володимирович','+380638992999','jarvis_stark@gmail.com','3')
go

INSERT INTO Працівники([Id],[Прізвище],[Імя],[По-батькові],[Номер тел]) VALUES
('Х1_1','Павлюк','Тамара',' Петрович ','+380966503943'),
('Х1_2','Середа','Павло','Романович','+380504196498'),
('О1_1','Васильчук','Вадим','Миколайович','+380968855693'),
('О1_2','Пономаренко','Анна','Валентинівна','+380636598407'),
('Д1_1','Кравчук','Надія','Анатоліївна','+380933603620'),
('Д1_2','Васильчук','Валентина','Борисовівна','+380635329644'),
('В1_1','Васильчук','Валентина','Олександрівна','+380635424875'),
('В1_2','Гнатюк','Валентин','Петрович','+380504694761'),
('Ч1_1','Крамаренко','Євген','Борисович','+380934694761'),
('Ч1_2','Петренко','Валерій','Євгенович','+380984694761'),
('І1_1','Захарчук','Bсеволод','Борисович','+380584694761'),
('І1_2','Шинкаренко','Дибіл','Васильович','+380974694761'),
('Хм1_1','Шинкаренко','Данил','Борисович','+380994694761'),
('ХМ1_2','Янович','Андрій','Федорович','+380502294761'),
('Р1_1','Дмитренко','Даря','Євгенівна','+380504693361'),
('Т1_1','Черкаавський','Микита','Олександрович','+380504694881'),
('З1_1','Крамарчук','Борис','Володимирович','+380504999991'),
('Р1_3','Романченко','Борис','Сергійович','+380588888861'),
('Р1_2','Микитюк','Борис','Федорович','+380594694761')
go
INSERT INTO Упаковка([Id],[Назва],[Опис]) VALUES
('1','Картонний тубус','Розмір, см: 15х13х60; '),
('2','Пакет',' (розмір - 40 см х 50 см );'),
('3','Картонна коробка ','Розмір, см: 17х12х10;  '),
('4','Гофрований картон',' (min замовлення 0,5 м²)'),
('5','Стрейч-плівка',' (Cтрейчування відправлення вагою до 2 кг)'),
('6','Повітряно-пухирчаста плівка',' (min замовлення 0,5 м2)'),
('7','Мішок поліпропіленовий','Розмір, см: 105х55; '),
('8','Картонний конверт (формат А4)','Розмір, см: 25х35; '),
('9','Коробка для ноутбука','Розмір, см: 58х31х6; '),
('10','Каркас пінопластовий малий','Розмір, см: 80х60х70; '),
('11','Бокс пластиковий','Внутрішній розмір, см ДхШхВ: 73х53х37;  '),
('12','Палетування',''),
('13','Ящик для автоскла','Внутрішній розмір, см ДхШхВ: 158х108х15; ')
go
INSERT INTO Постачальники([Id],[Назва],[Адреса],[Email],[Номер тел]) VALUES
('1','УкрКоР','місто Харків, просп.Перемоги, 23','ukrkor@ukr.net','+380972348251'),
('2','PackMeUa',' місто Київ, пл. Пацаєва, 48','packmeua@gmailcom','+380967113513')
go
use Delivery
go
INSERT INTO [Тип відділення]([Id],[Назва],[Опис]) VALUES
('1','Мале','Кількість працівників < 5; Оборот посилок (сер.зн.) - 68од.'),
('2','Середнє','Кількість працівників > 5, <10; Оборот посилок (сер.зн.) - 241од..'),
('3','Велике','Кількість працівників > 10; Оборот посилок (сер.зн.) - 489од.')
go

INSERT INTO Відділення([Id],[Id типу],[Область],[Місто],[Адреса],[Номер тел]) VALUES
('Х1','1','Харківська','Харків','просп. 50 років Жовтня, 21','+380947128251'),
('О1','2','Одеська','Одеса','просп. Генерала Жадова, 94','+380947119613'),
('Д1','3','Дніпропетровська','Дніпро','пров. Михайла Грушевського, 35','+380947101470'),
('В1','3','Вінницька','Вінниця','пл. Тараса Шевченка, 62','+380947113462'),
('Ч1','1','Чернігівська','Чернігів','пров. Гагаріна, 93','+380947112098'),
('І1','1','Івано-Франківська','Івано-Франківськ','просп. Пацаєва, 59','+380947117052'),
('Хм1','1','Хмельницька','Хмельницький','вул. Лесі Українки, 29','+380947125573'),
('Р1','2','Рівненська','Рівне','пров. Космонавта Попова, 78','+380947104624'),
('Т1','1','Тернопільська','Тернопіль', 'просп. Волкова, 70','+380947102349'),
('З1','1','Закарпатська','Ужгород','пров. Лесі Українки, 97','+380947999349')
go

INSERT INTO Постачальники([Id],[Назва],[Адреса],[Email],[Номер тел]) VALUES
('3','Termopack','  місто Львів, вул. Богдана Хмельницького, 45','termopack@ukr.net','+380972354671'),
('4','EkoTech',' місто Жидачів, вул Січових Стрільців, 12','ekotech1234@gmailcom','+380937113123')
go


INSERT INTO [Замовлення упаковки]([Id постачальника],[Id упаковки],[Дата],[Ціна],[Кількість]) VALUES
('3','4','2019-01-26','12','438'),
('2','5','2019-01-26','15','238'),
('1','6','2019-02-21','32','869'),
('4','11','2019-03-06','30','456'),
('1','3','2019-04-19','10','675'),
('4','1','2019-05-10','12','968'),
('3','9','2019-05-30','4','643'),
('2','13','2019-06-09','75','230'),
('1','12','2019-07-14','6','785'),
('1','2','2019-08-25','15','432'),
('2','7','2019-09-07','10','874'),
('3','10','2019-09-11','50','376'),
('4','8','2019-09-28','6','945')
go

INSERT INTO Замовлення([Id відпрівника],[Id отримувача],[Id відділення відправника],[Id відділення отримуача],[Id упаковки],[Id оп. відправника],[Id оп. отримувача],[Дата відправлення],[Дата отримання],[Вартість доставки]) VaLues

('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('3','5','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),
('2','3','Х1','O1','2','Х1_2','О1_2','2018-09-12','2018-09-15','150'),
('2','4','В1','Ч1','13','В1_1','Ч1_1','2018-09-13','2018-09-16','80'),


('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),

('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','',''),
('','','','','','','','','','')
go

Select count(id) from Клієнти